!function(e,$){e.campusPlayer=$("#campus-player");var s=e.campusPlayer,a,t,i={};mejs.plugins.silverlight[0].types.push("video/x-ms-wmv"),mejs.plugins.silverlight[0].types.push("audio/x-ms-wma"),MediaElementPlayer.prototype.buildimage=function(e,s){$('<div class="mejs-image"></div>').appendTo(s)},MediaElementPlayer.prototype.buildmore=function(e,s,a){var t=$('<div class="mejs-button mejs-more"><div class="meta-link more-link"><a class="meta-button" title="Options" href="#">'+n("live")+"</a></div></div>").appendTo(s),i=$('<div class="mejs-more-layer mejs-layer"><div class="mejs-layer-content"><div class="layer-section columns-elem"><div class="live-link dynamic-link"><a href="#" title="Écouter le direct">'+n("live")+'<span class="icon-title">Écouter le direct</span></a></div><div class="podcast-link dynamic-link"><a href="#" title="Reprendre la lecture du podcast">'+n("podcast")+'<span class="icon-title">Reprendre la lecture du podcast</span></a></div><div class="download-link dynamic-link"><a href="'+campus.player.podcast_infos.url+'" download target="_blank" title="Télécharger le podcast">'+n("download")+'<span class="icon-title">Télécharger le podcast</span></a></div><div class="podcast-post-link dynamic-link"><a href="#" title="Lire l\'article du podcast">'+n("podcast-post")+'<span class="icon-title">Lire l\'article du podcast</span></a></div><div class="search-song-link dynamic-link"><a title="Retrouve ton titre" href="#search-box" class="box-link">'+n("search-song")+'<span class="icon-title">Rechercher un titre</span></a></div><div class="programs-link dynamic-link"><a title="Tous les programmes" href="'+campus.programsUrl+'" class="box-link">'+n("program")+'<span class="icon-title">Tous les programmes</span></a></div><div class="player-popup-link dynamic-link min-1024"><a class="no-ajaxy" title="Écouter dans une nouvelle fenêtre (popup)" href="'+campus.playerUrl+'">'+n("player-popup")+'<span class="icon-title">Écouter dans une nouvelle fenêtre (popup)</span></a></div></div><div class="layer-section podcasts-elem"><div class="meta-link big backward-10-link"><a class="meta-button" title="Revenir de 10 secondes" href="#">'+n("backward-10")+'</a></div><div class="meta-link big backward-30-link"><a class="meta-button" title="Revenir de 30 secondes" href="#">'+n("backward-30")+'</a></div><div class="sep mejs-time-clone"></div><div class="meta-link big forward-30-link"><a class="meta-button" title="Avancer de 30 secondes" href="#">'+n("forward-30")+'</a></div><div class="meta-link big forward-10-link"><a class="meta-button" title="Avancer de 10 secondes" href="#">'+n("forward-10")+"</a></div></div></div></div>").appendTo(a);t.find(".more-link").on("click",function(e){e.preventDefault(),i.toggleClass("toggled-on")}).on("mouseenter",function(e){e.preventDefault(),i.addClass("toggled-on")}),$(document).on("click",function(e){!$(e.target).parents(".mejs-container").length&&i.is(":visible")&&i.removeClass("toggled-on")}).on("ajaxloading",function(){i.removeClass("toggled-on")});var l;i.on("mouseenter",function(e){e.preventDefault(),clearTimeout(l)}).on("mouseleave",function(e){e.preventDefault(),l=setTimeout(function(){i.removeClass("toggled-on")},300)}).find(".backward-10-link").click(function(s){s.preventDefault(),e.setCurrentTime(e.getCurrentTime()-10)}).end().find(".forward-10-link").click(function(s){s.preventDefault(),e.setCurrentTime(e.getCurrentTime()+10)}).end().find(".backward-30-link").click(function(s){s.preventDefault(),e.setCurrentTime(e.getCurrentTime()-30)}).end().find(".forward-30-link").click(function(s){s.preventDefault(),e.setCurrentTime(e.getCurrentTime()+30)})},MediaElementPlayer.prototype.buildtime=function(e,s,a,t){var i=this;$('<div class="mejs-time" role="timer" aria-live="off"><div class="mejs-podcast-time" style="display: none;"><span class="mejs-currenttime">'+(e.options.alwaysShowHours?"00:":"")+(e.options.showTimecodeFrameCount?"00:00:00":"00:00")+'</span><span class="mejs-duration" style="display: none;">'+(i.options.duration>0?mejs.Utility.secondsToTimeCode(i.options.duration,i.options.alwaysShowHours||i.media.duration>3600,i.options.showTimecodeFrameCount,i.options.framesPerSecond||25):(e.options.alwaysShowHours?"00:":"")+(e.options.showTimecodeFrameCount?"00:00:00":"00:00"))+'</span></div><div class="mejs-live-time"></div></div>').appendTo(s),i.currenttime=i.controls.find(".mejs-currenttime"),i.durationD=i.controls.find(".mejs-duration"),t.addEventListener("timeupdate",function(){l()&&(Cookies.set("campus-player-current-time",t.getCurrentTime(),{expires:30,path:"/"}),$(".mejs-time-clone").html($(".mejs-podcast-time").html()),e.updateDuration(),e.updateCurrent())},!1),setInterval(function(){l()||i.setCurrentLiveRail(e,s,a,t)},150)},MediaElementPlayer.prototype.loadLiveInfos=function(){if(this.loadingLiveInfos)return!1;var e=this;e.loadingLiveInfos=!0,$.ajax({url:campus.ajaxUrl,type:"POST",dataType:"json",data:{action:"get_live_results"},success:function(s){campus.player.live_infos=s,$("pre.ajax").length&&$("pre.ajax").html(JSON.stringify(s.results)),e.setPlayerInfos(!1),setTimeout(function(){e.loadingLiveInfos=!1},5e3)}})},MediaElementPlayer.prototype.setCurrentLiveRail=function(e,s){var a=this,t=s.find(".mejs-time-live");if(void 0!==campus.player.live_infos.start&&campus.player.live_infos.duration&&campus.player.live){var i=new Date,n=Math.floor(i.getTime()/1e3)-campus.player.live_infos.start;if(n>campus.player.live_infos.duration&&!a.loadingLiveInfos)a.loadLiveInfos();else{var l=n/campus.player.live_infos.duration;l=l>1?1:l,t.css({transform:"scaleX("+l+")"})}}else t.css({transform:"scaleX(0)"})},MediaElementPlayer.prototype.setPlayerInfos=function(e){var s,a;if(e=void 0===e||e,l()){s=Object.assign({},campus.player.podcast_infos),s.link&&!/href/.test(s.image)&&(s.image='<a href="'+s.link+'">'+s.image+"</a>");var t=Cookies.get("campus-player-current-time");a=!e&&t?t:0,this.controls.find(".mejs-podcast-time").show(),this.controls.find(".mejs-live-time").hide(),Cookies.set("campus-player-podcast-infos",s,{expires:30,path:"/"}),this.controls.find(".mejs-time-rail").removeClass("mejs-live-time-rail").addClass("mejs-podcast-time-rail")}else s=Object.assign({},campus.player.live_infos),s.url=campus.player.settings.url,e&&(s.url+="?"+(new Date).getTime()),this.controls.find(".mejs-live-time").html(s.display_time),this.controls.find(".mejs-podcast-time").hide(),this.controls.find(".mejs-live-time").show(),s.timeRailClass="mejs-live-time-rail",this.controls.find(".mejs-time-rail").removeClass("mejs-podcast-time-rail").addClass("mejs-live-time-rail");(l()||!l()&&e)&&this.setSrc(s.url),this.$media.attr("title",s.name),void 0!==a&&this.media.setCurrentTime(a),this.controls.find(".mejs-image").html('<div class="post-thumbnail">'+s.image+"</div>"),this.controls.find(".mejs-time-title").length?this.controls.find(".mejs-time-title").html(s.title):this.controls.find(".mejs-time-rail").prepend('<div class="mejs-time-title">'+s.title+"</div>"),this.controls.parent().removeClass(function(e,s){return s.replace("mejs-inner","")}).addClass(s.class),this.setLayer(),$(".hentry").removeClass("current paused"),$(document).trigger("setplayerinfos",[this,s]),Cookies.set("campus-player-live",campus.player.live?1:0,{expires:30,path:"/"})},MediaElementPlayer.prototype.setLive=function(){return campus.player.live=1,this.setPlayerInfos(),!0},MediaElementPlayer.prototype.setPodcast=function(e){if(void 0===e||!e.url)return alert("Le podcast ne peut pas être ajouté car les données ne sont pas conformes."),!1;var s=e.url!=campus.player.podcast_infos.url;return campus.player.live=0,campus.player.podcast_infos=e,this.setPlayerInfos(s),!0},MediaElementPlayer.prototype.setLayer=function(){l()?($(".dynamic-link.podcast-link").hide().find("a").data("podcast",campus.player.podcast_infos),$(".dynamic-link.download-link").show().find("a").attr("href",campus.player.podcast_infos.url),$(".dynamic-link.podcast-post-link").show().find("a").attr("href",campus.player.podcast_infos.link),$(".layer-section.podcasts-elem").slideDown()):($(".dynamic-link.podcast-link, .dynamic-link.download-link, .dynamic-link.podcast-post-link").hide(),campus.player.podcast_infos.url&&$(".dynamic-link.podcast-link").show().find("a").data("podcast",campus.player.podcast_infos).attr("title",$(".dynamic-link.podcast-link").text()+" : "+campus.player.podcast_infos.name),$(".layer-section.podcasts-elem").slideUp())};var n=function(e){return'<svg class="icon icon-'+e+'" aria-hidden="true" role="img"><use href="#icon-'+e+'" xlink:href="#icon-'+e+'"></use></svg>'},l=function(){return!campus.player.live&&void 0!==campus.player.podcast_infos&&""!==campus.player.podcast_infos.url},o=function(){if("undefined"==typeof campus)return!1;l()?campus.popup.height=campus.popup.podcastHeight:campus.popup.height=campus.popup.liveHeight,delete campus.popup.podcastHeight,delete campus.popup.liveHeight;var e="";return $.each(campus.popup,function(s,a){e+=s+"="+a+","}),e};$(document).ready(function(){$(".add-ajax-results").click(function(){$("pre.ajax").html(JSON.stringify(campus.player.live_infos.results))}),$(".load-ajax-results").click(function(){t.loadLiveInfos()})}).on("ajaxready",function(){l()||t.setPlayerInfos(!1)}).on("click",".mejs-time-wrap",function(){$(this).children(".mejs-currenttime").is(":visible")?($(".mejs-currenttime").hide(),$(".mejs-duration").show()):($(".mejs-currenttime").show(),$(".mejs-duration").hide())}).on("click",".podcast-link a",function(e){e.preventDefault();var s=$(this),a=s.parents(".hentry");a.hasClass("current")?a.hasClass("paused")?t.play():t.pause():""!==$(this).data("podcast")&&(t.pause(),t.setPodcast($(this).data("podcast"))&&t.play())}).on("click",".live-link a",function(e){e.preventDefault(),t.pause(),t.setLive()&&t.play()}).on("click",".playpause-link",function(e){e.preventDefault(),t.paused?t.play():t.pause()}).on("click",".player-popup-link a",function(s){s.preventDefault(),campus.playerUrl&&(t.pause(),e.open(campus.playerUrl+"?autoplay=1","_blank",o()))}),i={setDimensions:!1,alwaysShowHours:!1,enableAutosize:!1,features:["image","playpause","progress","time","more"],success:function(e){var s=e.attributes.autoplay&&"false"!==e.attributes.autoplay;"flash"===e.pluginType&&s&&e.addEventListener("canplay",function(){e.play()},!1);var a=$(e).parents(".mejs-container");a.find(".mejs-playpause-button button").html(campus.player.settings.button_playpause),a.find(".mejs-time-live").length||(a.find(".mejs-time-total").append('<span class="mejs-time-live"></span>'),e.liveRail=a.find(".mejs-time-live")[0]),e.addEventListener("play",function(){$(document).find(".playpause-link").parents(".list-item").addClass("current").removeClass("paused"),l()&&$(document).find("#post-"+campus.player.podcast_infos.id).addClass("current").removeClass("paused")}),e.addEventListener("pause",function(){$(document).find(".playpause-link").parents(".list-item").addClass("paused"),l()&&$(document).find("#post-"+campus.player.podcast_infos.id).addClass("paused")}),e.addEventListener("ended",function(){$(document).find(".playpause-link").parents(".list-item").removeClass("current paused"),l()&&($(document).find("#post-"+campus.player.podcast_infos.id).removeClass("current paused"),1e3*campus.player.live_infos.end<Date.now()&&t.loadLiveInfos()),t.setLive()})}},s.mediaelementplayer(i),a=s.parents(".mejs-container").length?s.parents(".mejs-container"):$(".site-player .mejs-container"),t=mejs.players[a.attr("id")],t.setPlayerInfos(!1)}(window,jQuery);